<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Echoes of the Loom - Madras Checks</title><meta name="viewport" content="width=device-width,initial-scale=1.0"><style>body{margin:0;background:#222;display:flex;align-items:center;justify-content:center;height:100vh;}canvas{background:transparent;border-radius:12px;box-shadow:0 4px 24px rgba(0,0,0,0.12);}</style></head><body><canvas id=c width=1024 height=1024></canvas><script>const config={"seed":"test","palette":["#cc0033","#ffee88","#004477","#ffffff"],"lint":true,"threadSpacing":1,"bgColor":"#222","opaque":true,"weaveStyle":"classic","threadVariance":0.3};const palette=["#cc0033","#ffee88","#004477","#ffffff"];const threadVariance=0.3;const weaveStyle="classic";function sfc32(a,b,c,d){return function(){a|=0;b|=0;c|=0;d|=0;var t=(a+(b|=0)|0)+(c|=0)+(d|=0);a=b^b>>>9;b=c+(c<<3)|0;c=(c<<21|c>>>11);d=d+1|0;return(t>>>0)/4294967296}}function xmur3(str){for(var i=0,h1=1779033703,h2=3144134277,h3=1013904242,h4=2773480762;i<str.length;i++){h1=h2^Math.imul(h1^str.charCodeAt(i),597399067);h2=h3^Math.imul(h2^str.charCodeAt(i),2869860233);h3=h4^Math.imul(h3^str.charCodeAt(i),951274213);h4=h1^Math.imul(h4^str.charCodeAt(i),2716044179);}h1=Math.imul(h3^h1>>>18,597399067);h2=Math.imul(h4^h2>>>22,2869860233);h3=Math.imul(h1^h3>>>17,951274213);h4=Math.imul(h2^h4>>>19,2716044179);return[(h1^h2^h3^h4)>>>0,(h2^h1)>>>0,(h3^h1)>>>0,(h4^h1)>>>0]}const seedArr=xmur3(config.seed||"madras");const rand=sfc32(seedArr[0],seedArr[1],seedArr[2],seedArr[3]);const c=document.getElementById("c"),x=c.getContext("2d",{alpha:true});const w=1024,h=1024;function r(a,b){return a+rand()*(b-a);}function rc(arr){return arr[Math.floor(rand()*arr.length)];}function hexToRgb(hex){hex=hex.replace("#","");if(hex.length===3)hex=hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2];var num=parseInt(hex,16);return[num>>16&255,num>>8&255,num&255];}function rgbToStr(rgb){return"rgb("+rgb[0]+","+rgb[1]+","+rgb[2]+")";}function blend(a,b,alpha){return[Math.round(a[0]*(1-alpha)+b[0]*alpha),Math.round(a[1]*(1-alpha)+b[1]*alpha),Math.round(a[2]*(1-alpha)+b[2]*alpha)];}function shuffle(arr){for(let i=arr.length-1;i>0;i--){let j=Math.floor(rand()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}return arr;}function genStripes(len,thinChance){let stripes=[],remain=len;let colors=shuffle(palette.slice());while(remain>0){let isThin=rand()<thinChance;let w=isThin?Math.floor(r(1,3)):Math.max(8,Math.floor(r(18,64)));let c=colors[Math.floor(rand()*colors.length)];stripes.push({width:Math.min(w,remain),color:c,thin:isThin});remain-=w;}return stripes;}let hStripes=genStripes(h,0.18),vStripes=genStripes(w,0.18);let hPos=[],vPos=[];let acc=0;for(let s of hStripes){for(let i=0;i<s.width;i++)hPos.push({color:s.color,idx:acc+i,thin:s.thin});acc+=s.width;}acc=0;for(let s of vStripes){for(let i=0;i<s.width;i++)vPos.push({color:s.color,idx:acc+i,thin:s.thin});acc+=s.width;}x.clearRect(0,0,w,h);if (true) { x.fillStyle = "#222"; x.fillRect(0,0,w,h); }const spacing = Math.max(1, Number(config.threadSpacing) || 1);if(weaveStyle==="classic"){for(let i=0;i<h;i+=spacing){let hCol=hexToRgb(hPos[Math.floor(i)%hPos.length].color),hThin=hPos[Math.floor(i)%hPos.length].thin;let y=i+r(-0.7,0.7)*threadVariance;let thickness=hThin?1.1:1.7+r(-0.7,0.7)*threadVariance*2;x.save();x.globalAlpha=hThin?0.85:0.65;x.strokeStyle=rgbToStr(hCol);x.lineWidth=thickness;x.beginPath();let waviness=threadVariance*2;for(let x0=0;x0<w;x0+=8){let wy=y+r(-waviness,waviness);if(x0===0)x.moveTo(x0,wy);else x.lineTo(x0,wy);}x.stroke();x.restore();}for(let j=0;j<w;j+=spacing){let vCol=hexToRgb(vPos[Math.floor(j)%vPos.length].color),vThin=vPos[Math.floor(j)%vPos.length].thin;let xj=j+r(-0.7,0.7)*threadVariance;let thickness=vThin?1.1:1.7+r(-0.7,0.7)*threadVariance*2;x.save();x.globalAlpha=vThin?0.85:0.65;x.strokeStyle=rgbToStr(vCol);x.lineWidth=thickness;x.beginPath();let waviness=threadVariance*2;for(let y0=0;y0<h;y0+=8){let wx=xj+r(-waviness,waviness);if(y0===0)x.moveTo(wx,y0);else x.lineTo(wx,y0);}x.stroke();x.restore();}}else if(weaveStyle==="woven"){for(let i=0;i<h;i+=spacing){let hCol=hexToRgb(hPos[Math.floor(i)%hPos.length].color),hThin=hPos[Math.floor(i)%hPos.length].thin;let y=i;x.save();x.globalAlpha=hThin?0.85:0.65;x.strokeStyle=rgbToStr(hCol);x.lineWidth=hThin?1.1:1.7;x.beginPath();x.moveTo(0,y);x.lineTo(w,y);x.stroke();x.restore();}for(let j=0;j<w;j+=spacing){let vCol=hexToRgb(vPos[Math.floor(j)%vPos.length].color),vThin=vPos[Math.floor(j)%vPos.length].thin;let xj=j;x.save();x.globalAlpha=vThin?0.85:0.65;x.strokeStyle=rgbToStr(vCol);x.lineWidth=vThin?1.1:1.7;x.beginPath();x.moveTo(xj,0);x.lineTo(xj,h);x.stroke();x.restore();}}else if(weaveStyle==="handloom"){for(let i=0;i<h;i+=spacing){let hCol=hexToRgb(hPos[Math.floor(i)%hPos.length].color),hThin=hPos[Math.floor(i)%hPos.length].thin;let y=i+r(-0.7,0.7)*threadVariance;x.save();x.globalAlpha=hThin?0.85:0.65;x.strokeStyle=rgbToStr(hCol);x.beginPath();let waviness=threadVariance*2;for(let x0=0;x0<w;x0+=8){let wy=y+r(-waviness,waviness);let thickness=hThin?1.1+r(-0.7,0.7)*threadVariance*2:1.7+r(-0.7,0.7)*threadVariance*3;x.lineWidth=thickness;if(x0===0)x.moveTo(x0,wy);else x.lineTo(x0,wy);}x.stroke();x.restore();}for(let j=0;j<w;j+=spacing){let vCol=hexToRgb(vPos[Math.floor(j)%vPos.length].color),vThin=vPos[Math.floor(j)%vPos.length].thin;let xj=j+r(-0.7,0.7)*threadVariance;x.save();x.globalAlpha=vThin?0.85:0.65;x.strokeStyle=rgbToStr(vCol);x.beginPath();let waviness=threadVariance*2;for(let y0=0;y0<h;y0+=8){let wx=xj+r(-waviness,waviness);let thickness=vThin?1.1+r(-0.7,0.7)*threadVariance*2:1.7+r(-0.7,0.7)*threadVariance*3;x.lineWidth=thickness;if(y0===0)x.moveTo(wx,y0);else x.lineTo(wx,y0);}x.stroke();x.restore();}}else if(weaveStyle==="pc"){for(let i=0;i<h;i+=spacing){let hCol=hexToRgb(hPos[Math.floor(i)%hPos.length].color);let y=i;x.save();x.globalAlpha=0.7;x.strokeStyle=rgbToStr(hCol);x.lineWidth=1.2;x.beginPath();for(let x0=0;x0<w;x0+=8){let wy=y+r(-2,2);if(x0===0)x.moveTo(x0,wy);else x.lineTo(x0,wy);}x.stroke();x.restore();}for(let j=0;j<w;j+=spacing){let vCol=hexToRgb(vPos[Math.floor(j)%vPos.length].color);let xj=j;x.save();x.globalAlpha=0.7;x.strokeStyle=rgbToStr(vCol);x.lineWidth=1.2;x.beginPath();for(let y0=0;y0<h;y0+=8){let wx=xj+r(-2,2);if(y0===0)x.moveTo(wx,y0);else x.lineTo(wx,y0);}x.stroke();x.restore();}}